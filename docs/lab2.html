<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Dávid Sümeghy" />


<title>Journal 1</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="tweaks.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    My journal
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="lab1.html">Day 1</a>
    </li>
    <li>
      <a href="lab2.html">Day 2</a>
    </li>
    <li>
      <a href="lab3.html">Day 3</a>
    </li>
    <li>
      <a href="lab5.html">Day 5</a>
    </li>
    <li>
      <a href="lab6.html">Day 6</a>
    </li>
    <li>
      <a href="assignment.html">Final presentation</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sudave13/bigssslabjournal">
    <span class="fab fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Journal 1</h1>
<h4 class="author">Dávid Sümeghy</h4>

</div>


<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<p>Last compiled on július, 2022</p>
<p><br></p>
<hr />
<pre class="r test"><code>rm(list = ls())</code></pre>
<pre class="r test"><code>fsave &lt;- function(x, file, location = &quot;./data/processed/&quot;, ...) {
    if (!dir.exists(location))
        dir.create(location)
    datename &lt;- substr(gsub(&quot;[:-]&quot;, &quot;&quot;, Sys.time()), 1, 8)
    totalname &lt;- paste(location, datename, file, sep = &quot;&quot;)
    print(paste(&quot;SAVED: &quot;, totalname, sep = &quot;&quot;))
    save(x, file = totalname)
}

fpackage.check &lt;- function(packages) {
    lapply(packages, FUN = function(x) {
        if (!require(x, character.only = TRUE)) {
            install.packages(x, dependencies = TRUE)
            library(x, character.only = TRUE)
        }
    })
}

colorize &lt;- function(x, color) {
    sprintf(&quot;&lt;span style=&#39;color: %s;&#39;&gt;%s&lt;/span&gt;&quot;, color, x)
}</code></pre>
<pre class="r test"><code>packages &lt;- c(&quot;haven&quot;, &quot;tidyverse&quot;,&quot;srvyr&quot;,&quot;sjlabelled&quot;)
fpackage.check(packages)</code></pre>
<pre class="test2"><code>#&gt; [[1]]
#&gt; NULL
#&gt; 
#&gt; [[2]]
#&gt; NULL
#&gt; 
#&gt; [[3]]
#&gt; NULL
#&gt; 
#&gt; [[4]]
#&gt; NULL</code></pre>
<pre class="r test"><code># load in the data
kieskom &lt;- read.csv(&quot;./data/kieskompas_df.csv&quot;)
# names(kieskom) #variable labels are the Dutch statements... let&#39;s relabel them

names(kieskom)[-c(1, 2)] &lt;- labs &lt;- c(&quot;build1&quot;, &quot;build2&quot;, &quot;build3&quot;, &quot;democracy1&quot;, &quot;democracy2&quot;, &quot;democracy3&quot;,
    &quot;democracy4&quot;, &quot;social1&quot;, &quot;social2&quot;, &quot;social3&quot;, &quot;social4&quot;, &quot;climate1&quot;, &quot;climate2&quot;, &quot;climate3&quot;, &quot;climate4&quot;,
    &quot;educ_care1&quot;, &quot;educ_care2&quot;, &quot;educ_care3&quot;, &quot;educ_care4&quot;, &quot;educ_care5&quot;, &quot;immigration1&quot;, &quot;immigration2&quot;,
    &quot;immigration3&quot;, &quot;foreign_policy1&quot;, &quot;foreign_policy2&quot;, &quot;foreign_policy3&quot;, &quot;foreign_policy4&quot;, &quot;justice1&quot;,
    &quot;justice2&quot;, &quot;justice3&quot;)
kieskom &lt;- kieskom[-1]  # exclude the indicator column
names(kieskom)[-1] &lt;- paste0(&quot;kieskom_&quot;, names(kieskom)[-1])  # add a kieskom label to the column names
names(kieskom)[1] &lt;- &quot;party&quot;</code></pre>
<pre class="r test"><code># public data include expert-level data (ie, expert judgement); and mean and median judgements we
# use data at the expert-level
pop &lt;- read_dta(&quot;./data/expert_data_stata.dta&quot;)

# subset Dutch parties (country id=19)
pop &lt;- pop[which(pop$country_id == 19), ]

# subset party and dimensions names(pop)
pop &lt;- pop[, c(4, 6:21)]
# add poppa label to variables names(pop)[-c(1)] &lt;- paste0(&#39;pop_&#39;,names(pop)[-c(1)])</code></pre>
<pre class="r test"><code>ches &lt;- read_dta(&quot;./data/CHES2019_experts.dta&quot;)
ches &lt;- as.data.frame(ches)

dutch &lt;- 1001:1051  #Dutch party ids
ches &lt;- ches[ches$party_id %in% dutch, ]  #subset Dutch parties

# subset party and dimensions names(ches)
ches &lt;- ches[, c(3, 5:49)]

# add ches label to variables names(ches)[-c(1)] &lt;- paste0(&#39;ches_&#39;,names(ches)[-c(1)])
# unique(pop$party) unique(ches$party_name)</code></pre>
<p>Assignment 1</p>
<p>What is the conclusion of the authors about inferring about a party position using the mean of expert responses?</p>
<p>The mean is biased both when experts perceive the scale in the same way (a) and when some experts in the experiment are coded to take a different view from the majority (b). Increasing the number of items reduces the noise but does not eliminate the bias. Lindstädt and colleagues suggest using the median, although it also underestimates the truth in case b.</p>
<p>Lindstädt and colleagues state: “Studies using expert surveys largely rely on mean expert placement, using standard deviations or standard errors to assess uncertainty. Yet, the shape of expert placement distributions can vary drastically across the items in a survey. Political parties, for example, can have similar estimated mean party positions based on very different distributions of expert placements.” Pick an item that reflects a policy dimension you are intested in, from either the POPPA or CHES dataset. Find Dutch parties that have approximately equal mean-scores on that particular item; and investigate how the shape of expert placement distributions varies across these parties. Use histograms to illustrate. If you need help, click the Code button on the right</p>
<pre class="r test"><code>environment&lt;- ches %&gt;% 
group_by(party_name) %&gt;% 
summarise(m_env=mean(environment,na.rm=T))
print (environment)</code></pre>
<pre class="test2"><code>#&gt; # A tibble: 13 x 2
#&gt;    party_name m_env
#&gt;    &lt;chr&gt;      &lt;dbl&gt;
#&gt;  1 50PLUS      5.57
#&gt;  2 CDA         6.54
#&gt;  3 CU          4.58
#&gt;  4 D66         4.15
#&gt;  5 DENK        4.2 
#&gt;  6 FvD         9.31
#&gt;  7 GL          1.54
#&gt;  8 PvdA        4.23
#&gt;  9 PVdD        1   
#&gt; 10 PVV         9   
#&gt; 11 SGP         6.91
#&gt; 12 SP          4.58
#&gt; 13 VVD         7.69</code></pre>
<pre class="r test"><code>ggplot(ches, aes(x=environment)) + 
  geom_histogram(aes(y=stat(count), fill=party_name)) +
  facet_grid(.~party_name)+ylab(&quot;Count&quot;)+
  xlab(&quot;Enviromental position&quot;)+
  scale_x_continuous(breaks = c(0,2,4,6,8,10))</code></pre>
<p><img src="lab2_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Based on the article and your own empirical insights, make an informed decision about how to aggregate the expert-level responses regarding this dimension to the party-level. Use this strategy to aggregate the responses and construct a dataframe (named: df) with rows reflecting the parties and column reflecting the aggregated scores on the picked dimension(s). If you need help, click the Code button on the right</p>
<pre class="r test"><code>df&lt;-ches %&gt;% 
group_by(party_name) %&gt;% 
summarise_all(list(median=~median(., na.rm = TRUE))) %&gt;% 
ungroup()</code></pre>
<pre class="r test"><code># first translate party characters to lower case
kieskom$party &lt;- tolower(kieskom$party)
df$party &lt;- tolower(df$party_name)

# merge by party;
merged &lt;- merge(df, kieskom, by = &quot;party&quot;, all = T) %&gt;% 
  select(-party_name)</code></pre>
<pre class="r test"><code>dpes &lt;- read_spss(&quot;./data/DPES2021_v1.0.sav&quot;,convert.factors = FALSE)</code></pre>
<pre class="r test"><code>mosque&lt;-dpes %&gt;%
  filter(!is.na(Wght_Tot)) %&gt;% 
  as_survey(weights = c(Wght_Tot)) %&gt;%
  group_by(N76) %&gt;% #Which party will you vote for?
  summarize(mean = survey_mean(V143, na.rm = T)) #The government should prevent the construction of new Mosques in the Netherlands.</code></pre>
<pre class="r test"><code>mosque_region&lt;-dpes %&gt;%
  filter(!is.na(Wght_Tot)) %&gt;% 
  as_survey(weights = c(Wght_Tot)) %&gt;%
  group_by(N76,D001) %&gt;% #Which party will you vote for? &amp; Region
  summarize(mean = survey_mean(V143, na.rm = T)) #The government should prevent the construction of new Mosques in the Netherlands.</code></pre>
<pre class="r test"><code>ggplot(mosque_region, aes(x=as.factor(N76),y=mean)) + 
  geom_point(aes(colour=as.factor(D001)),size=3) +
  ylab(&quot;Mean position&quot;)+
  xlab(&quot;Party codes&quot;)+
  scale_colour_manual(name=&quot;Regions&quot;,labels=c(&#39;North&#39;,&#39;East&#39;,&quot;West&quot;,&quot;South&quot;),values = c(&quot;red&quot;,&quot;blue&quot;,&quot;yellow&quot;,&quot;green&quot;))</code></pre>
<p><img src="lab2_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre class="r test"><code>parties&lt;-as.data.frame(get_labels(dpes$N76)) #obtaining the party name labels</code></pre>
<pre><code>

```{.r .test}
names(mosque)[1]&lt;-&quot;party_name&quot; #defining common column names
parties&lt;-parties %&gt;% mutate(row_number= 1:n())
names(parties)[2]&lt;-&quot;party_name&quot;</code></pre>
<pre class="r test"><code>merge &lt;- merge(parties, mosque, by = &quot;party_name&quot;, all = T) %&gt;% #merge mosque positions with party names
filter(!is.na(mean))</code></pre>
<pre class="r test"><code>names(merge)[1]&lt;-&quot;party_code&quot; #creating the common column name for matching with merged df
names(merge)[2]&lt;-&quot;party&quot;
merge&lt;-merge %&gt;% 
mutate(party = recode(party, &#39;boerburgerbeweging&#39;= &#39;bbb&#39;)) %&gt;%  #replacing names with abbreviations
mutate(party = recode(party, &#39;groenlinks&#39;= &#39;gl&#39;)) %&gt;% 
mutate(party = recode(party, &#39;christenunie&#39;= &#39;cu&#39;)) %&gt;% 
mutate(party = recode(party, &#39;forum voor democratie&#39;= &#39;fvd&#39;)) 
merge$party &lt;- tolower(merge$party)</code></pre>
<pre class="r test"><code>finalmerge &lt;- merge(merged, merge, by = &quot;party&quot;, all = T) </code></pre>
<pre class="r test"><code>fsave(finalmerge, &quot;positions_data.RData&quot;)</code></pre>
<pre class="test2"><code>#&gt; [1] &quot;SAVED: ./data/processed/20220713positions_data.RData&quot;</code></pre>
<p>fsave(merged, “positions_data2.RData”)</p>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
